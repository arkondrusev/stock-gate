package com.sadkoala.stockgate.parser;

import com.fasterxml.jackson.databind.JsonNode;
import com.sadkoala.stockgate.GateUtils;
import com.sadkoala.stockgate.parser.model.Order;
import com.sadkoala.stockgate.parser.model.OrderbookEntry;
import com.sadkoala.stockgate.parser.model.Ticker;

import java.io.IOException;
import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.List;
import java.util.Objects;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class HitbtcParser extends AbstractStockParser {

    /**
     * [{"id":225718606381,"clientOrderId":"e10f7723a05b40388a7f44169c8ef66a","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"7725.00","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-03-24T08:36:42.847Z","updatedAt":"2020-03-24T08:36:42.847Z"},{"id":218085627589,"clientOrderId":"3f440af39de540788cdd1e8c15f4da0d","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"8323.00","quantity":"0.00150","postOnly":false,"cumQuantity":"0","createdAt":"2020-03-08T23:15:20.726Z","updatedAt":"2020-03-08T23:15:20.726Z"},{"id":219577472229,"clientOrderId":"7cf12c22403d408484ec45bbaf46450d","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"7477.00","quantity":"0.00150","postOnly":false,"cumQuantity":"0","createdAt":"2020-03-12T09:38:29.633Z","updatedAt":"2020-03-12T09:38:29.633Z"},{"id":212641851519,"clientOrderId":"82d4e808efd945e1a04610c97e10e14f","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"9793.00","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-02-24T17:42:13.828Z","updatedAt":"2020-02-24T17:42:13.828Z"},{"id":226946723121,"clientOrderId":"e8e45b2fce654c35a772c81b329428ab","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"6745.00","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-03-27T14:56:56.942Z","updatedAt":"2020-03-27T14:56:56.942Z"},{"id":213562926372,"clientOrderId":"3dfa9bc0ec1648a9afc1d5f247503815","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"9313.00","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-02-26T13:42:49.504Z","updatedAt":"2020-02-26T13:42:49.504Z"},{"id":206813589902,"clientOrderId":"ref5Fgs725147b1e-1cc6-4dbe-b033-","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"10510.00","quantity":"0.00300","postOnly":false,"cumQuantity":"0","createdAt":"2020-02-12T11:30:08.344Z","updatedAt":"2020-02-12T11:30:08.344Z"},{"id":217907502363,"clientOrderId":"ref5Fgs70797b0c2-074f-4787-aaa1-","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"8775.00","quantity":"0.00150","postOnly":false,"cumQuantity":"0","createdAt":"2020-03-08T14:31:17.604Z","updatedAt":"2020-03-08T14:31:17.604Z"},{"id":213163996266,"clientOrderId":"95dfb65501a34a179b08eed567149051","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"9500.00","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-02-25T19:48:29.225Z","updatedAt":"2020-02-25T19:48:29.225Z"},{"id":226206821923,"clientOrderId":"949177b120d8431495716ab63a0082da","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"6975.00","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-03-25T11:54:57.234Z","updatedAt":"2020-03-25T11:54:57.234Z"},{"id":212312807618,"clientOrderId":"466e57034950493c90e2502f4b5d66c1","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"10092.00","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-02-24T00:58:45.772Z","updatedAt":"2020-02-24T00:58:45.772Z"},{"id":225340349001,"clientOrderId":"2b445e2b1c6b462eb453660822d0eb34","symbol":"BTCUSD","side":"sell","status":"new","type":"limit","timeInForce":"GTC","price":"7225.00","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-03-23T12:55:51.541Z","updatedAt":"2020-03-23T12:55:51.541Z"}]
     */
    public static List<Order> parseOpenOrders(final String jsonString) throws IOException {
        List<Order> parsedOrders = new ArrayList<>();
        for (JsonNode order : mapper.readTree(jsonString)) {
            parsedOrders.add(parseOrder(order));
        }
        return parsedOrders;
    }

    private static Long hitbtcTimeDateToMilliseconds(String timeDate) {
        return null;
    }

    /**
     * [{"currency":"1ST","available":"0","reserved":"0"},{"currency":"8BT","available":"0","reserved":"0"},{"currency":"ABA","available":"0","reserved":"0"},{"currency":"ABTC","available":"0","reserved":"0"},{"currency":"ABYSS","available":"0","reserved":"0"},{"currency":"ACAT","available":"0","reserved":"0"},{"currency":"ACO","available":"0","reserved":"0"},{"currency":"ACT","available":"0","reserved":"0"},{"currency":"ADA","available":"0","reserved":"0"},{"currency":"ADH","available":"0","reserved":"0"},{"currency":"ADK","available":"0","reserved":"0"},{"currency":"ADX","available":"0","reserved":"0"},{"currency":"AE","available":"0.00600000","reserved":"0"},{"currency":"AEON","available":"0","reserved":"0"},{"currency":"AGI","available":"0","reserved":"0"},{"currency":"AION","available":"0","reserved":"0"},{"currency":"AIR","available":"0","reserved":"0"},{"currency":"ALGO","available":"0","reserved":"0"},{"currency":"AMB","available":"0","reserved":"0"},{"currency":"AMM","available":"0","reserved":"0"},{"currency":"AMP","available":"0","reserved":"0"},{"currency":"ANT","available":"0","reserved":"0"},{"currency":"APL","available":"0","reserved":"0"},{"currency":"APM","available":"0","reserved":"0"},{"currency":"APPC","available":"0","reserved":"0"},{"currency":"ARCT","available":"0","reserved":"0"},{"currency":"ARDR","available":"0","reserved":"0"},{"currency":"ARN","available":"0","reserved":"0"},{"currency":"ARPA","available":"0","reserved":"0"},{"currency":"ART","available":"0","reserved":"0"},{"currency":"ATB","available":"0","reserved":"0"},{"currency":"ATL","available":"0","reserved":"0"},{"currency":"ATM","available":"0","reserved":"0"},{"currency":"ATOM","available":"0","reserved":"0"},{"currency":"ATS","available":"0","reserved":"0"},{"currency":"AUC","available":"0","reserved":"0"},{"currency":"AUTO","available":"0","reserved":"0"},{"currency":"AVA","available":"0","reserved":"0"},{"currency":"AVH","available":"0","reserved":"0"},{"currency":"AVT","available":"0","reserved":"0"},{"currency":"AXP","available":"0","reserved":"0"},{"currency":"AXPR","available":"0","reserved":"0"},{"currency":"B2G","available":"0","reserved":"0"},{"currency":"B2X","available":"0","reserved":"0"},{"currency":"BANCA","available":"0","reserved":"0"},{"currency":"BAR","available":"0","reserved":"0"},{"currency":"BAS","available":"0","reserved":"0"},{"currency":"BAT","available":"0","reserved":"0"},{"currency":"BBC","available":"0","reserved":"0"},{"currency":"BCC","available":"0","reserved":"0"},{"currency":"BCHOLD","available":"0","reserved":"0"},{"currency":"BCD","available":"0","reserved":"0"},{"currency":"BCH","available":"0","reserved":"0"},{"currency":"BSV","available":"0","reserved":"0"},{"currency":"BCI","available":"0","reserved":"0"},{"currency":"BCN","available":"0","reserved":"0"},{"currency":"BCPT","available":"0","reserved":"0"},{"currency":"BCST","available":"0","reserved":"0"},{"currency":"BDG","available":"0","reserved":"0"},{"currency":"BDP","available":"0","reserved":"0"},{"currency":"BERRY","available":"0","reserved":"0"},{"currency":"BET","available":"0","reserved":"0"},{"currency":"BETR","available":"0","reserved":"0"},{"currency":"BEZ","available":"0","reserved":"0"},{"currency":"BGG","available":"0","reserved":"0"},{"currency":"BIT","available":"0","reserved":"0"},{"currency":"BITS","available":"0","reserved":"0"},{"currency":"BKB","available":"0","reserved":"0"},{"currency":"BKX","available":"0","reserved":"0"},{"currency":"BLZ","available":"0","reserved":"0"},{"currency":"BMC","available":"0","reserved":"0"},{"currency":"BMH","available":"0","reserved":"0"},{"currency":"BMT","available":"0","reserved":"0"},{"currency":"BNB","available":"0","reserved":"0"},{"currency":"BNK","available":"0","reserved":"0"},{"currency":"BNT","available":"0","reserved":"0"},{"currency":"BOS","available":"0","reserved":"0"},{"currency":"BOX","available":"0","reserved":"0"},{"currency":"BPTN","available":"0","reserved":"0"},{"currency":"BQX","available":"0","reserved":"0"},{"currency":"BRD","available":"0","reserved":"0"},{"currency":"BRDG","available":"0","reserved":"0"},{"currency":"BST","available":"0","reserved":"0"},{"currency":"BSTN","available":"0","reserved":"0"},{"currency":"BTC","available":"0.000000523500","reserved":"0.019500000000"},{"currency":"BTCA","available":"0","reserved":"0"},{"currency":"BTCB","available":"0","reserved":"0"},{"currency":"BTCP","available":"0","reserved":"0"},{"currency":"BTG","available":"0","reserved":"0"},{"currency":"BTM","available":"0","reserved":"0"},{"currency":"BTS","available":"0","reserved":"0"},{"currency":"BTT","available":"0","reserved":"0"},{"currency":"BUS","available":"0","reserved":"0"},{"currency":"BTX","available":"0","reserved":"0"},{"currency":"BUBO","available":"0","reserved":"0"},{"currency":"BUSD","available":"0","reserved":"0"},{"currency":"C20","available":"0","reserved":"0"},{"currency":"CAPP","available":"0","reserved":"0"},{"currency":"CAS","available":"0","reserved":"0"},{"currency":"CAT","available":"0","reserved":"0"},{"currency":"CBC","available":"0","reserved":"0"},{"currency":"CCL","available":"0","reserved":"0"},{"currency":"CCT","available":"0","reserved":"0"},{"currency":"CDCC","available":"0","reserved":"0"},{"currency":"CDT","available":"0","reserved":"0"},{"currency":"CDX","available":"0","reserved":"0"},{"currency":"CEL","available":"0","reserved":"0"},{"currency":"CELR","available":"0","reserved":"0"},{"currency":"CENNZ","available":"0","reserved":"0"},{"currency":"CTR","available":"0","reserved":"0"},{"currency":"CFI","available":"0","reserved":"0"},{"currency":"CGC","available":"0","reserved":"0"},{"currency":"CHAT","available":"0","reserved":"0"},{"currency":"CHP","available":"0","reserved":"0"},{"currency":"CHSB","available":"0","reserved":"0"},{"currency":"CHX","available":"0","reserved":"0"},{"currency":"CHZ","available":"0","reserved":"0"},{"currency":"CL","available":"0","reserved":"0"},{"currency":"CLD","available":"0","reserved":"0"},{"currency":"CLN","available":"0","reserved":"0"},{"currency":"CLO","available":"0","reserved":"0"},{"currency":"CLOUT","available":"0","reserved":"0"},{"currency":"CLR","available":"0","reserved":"0"},{"currency":"CMCT","available":"0","reserved":"0"},{"currency":"CMT","available":"0","reserved":"0"},{"currency":"CND","available":"0","reserved":"0"},{"currency":"CNX","available":"0","reserved":"0"},{"currency":"COCOS","available":"0","reserved":"0"},{"currency":"COIN","available":"0","reserved":"0"},{"currency":"COSM","available":"0","reserved":"0"},{"currency":"COSS","available":"0","reserved":"0"},{"currency":"COV","available":"0","reserved":"0"},{"currency":"CPAY","available":"0","reserved":"0"},{"currency":"CPG","available":"0","reserved":"0"},{"currency":"CPT","available":"0","reserved":"0"},{"currency":"CPY","available":"0","reserved":"0"},{"currency":"CRO","available":"0","reserved":"0"},{"currency":"CRPT","available":"0","reserved":"0"},{"currency":"CRS","available":"0","reserved":"0"},{"currency":"CSM","available":"0","reserved":"0"},{"currency":"CSNO","available":"0","reserved":"0"},{"currency":"CTE","available":"0","reserved":"0"},{"currency":"CTX","available":"0","reserved":"0"},{"currency":"CUTE","available":"0","reserved":"0"},{"currency":"CVC","available":"0","reserved":"0"},{"currency":"CVCOIN","available":"0","reserved":"0"},{"currency":"CVH","available":"0","reserved":"0"},{"currency":"CVT","available":"0","reserved":"0"},{"currency":"DADI","available":"0","reserved":"0"},{"currency":"DAG","available":"0","reserved":"0"},{"currency":"DAI","available":"0","reserved":"0"},{"currency":"DAN","available":"0","reserved":"0"},{"currency":"DAPP","available":"0","reserved":"0"},{"currency":"DASH","available":"0","reserved":"0"},{"currency":"DATA","available":"0","reserved":"0"},{"currency":"DATX","available":"0","reserved":"0"},{"currency":"DAV","available":"0","reserved":"0"},{"currency":"DAXT","available":"0","reserved":"0"},{"currency":"DAY","available":"0","reserved":"0"},{"currency":"DBET","available":"0","reserved":"0"},{"currency":"DBIX","available":"0","reserved":"0"},{"currency":"DCN","available":"0","reserved":"0"},{"currency":"DCNT","available":"0","reserved":"0"},{"currency":"DCR","available":"0","reserved":"0"},{"currency":"DCT","available":"0","reserved":"0"},{"currency":"DDF","available":"0","reserved":"0"},{"currency":"DLT","available":"0","reserved":"0"},{"currency":"DENT","available":"0","reserved":"0"},{"currency":"DGB","available":"0","reserved":"0"},{"currency":"DGD","available":"0","reserved":"0"},{"currency":"DGTX","available":"0","reserved":"0"},{"currency":"DICE","available":"0","reserved":"0"},{"currency":"DIM","available":"0","reserved":"0"},{"currency":"DIT","available":"0","reserved":"0"},{"currency":"DNT","available":"0","reserved":"0"},{"currency":"DOGE","available":"0","reserved":"0"},{"currency":"DOR","available":"0","reserved":"0"},{"currency":"DOV","available":"0","reserved":"0"},{"currency":"DPN","available":"0","reserved":"0"},{"currency":"DRG","available":"0","reserved":"0"},{"currency":"DRGN","available":"0","reserved":"0"},{"currency":"DRPU","available":"0","reserved":"0"},{"currency":"DRT","available":"0","reserved":"0"},{"currency":"DSH","available":"0","reserved":"0"},{"currency":"DTR","available":"0","reserved":"0"},{"currency":"DWS","available":"0","reserved":"0"},{"currency":"EBET","available":"0","reserved":"0"},{"currency":"EBKC","available":"0","reserved":"0"},{"currency":"EBTCOLD","available":"0","reserved":"0"},{"currency":"EBTC","available":"0","reserved":"0"},{"currency":"ENG","available":"0","reserved":"0"},{"currency":"ECH","available":"0","reserved":"0"},{"currency":"ECOIN","available":"0","reserved":"0"},{"currency":"EDG","available":"0","reserved":"0"},{"currency":"EDO","available":"0","reserved":"0"},{"currency":"EET","available":"0","reserved":"0"},{"currency":"EJOY","available":"0","reserved":"0"},{"currency":"EKO","available":"0","reserved":"0"},{"currency":"ELE","available":"0","reserved":"0"},{"currency":"ELEC","available":"0","reserved":"0"},{"currency":"ELF","available":"0","reserved":"0"},{"currency":"ELM","available":"0","reserved":"0"},{"currency":"EMC","available":"0","reserved":"0"},{"currency":"EMGO","available":"0","reserved":"0"},{"currency":"EMRX","available":"0","reserved":"0"},{"currency":"ENGT","available":"0","reserved":"0"},{"currency":"ENJ","available":"0","reserved":"0"},{"currency":"EOS","available":"0","reserved":"0"},{"currency":"EOSDT","available":"0","reserved":"0"},{"currency":"ERD","available":"0","reserved":"0"},{"currency":"ERO","available":"0","reserved":"0"},{"currency":"ERT","available":"0","reserved":"0"},{"currency":"ETBS","available":"0","reserved":"0"},{"currency":"ETC","available":"0","reserved":"0"},{"currency":"ETH","available":"0.000002320000","reserved":"0"},{"currency":"ETHBNT","available":"0","reserved":"0"},{"currency":"ETN","available":"0","reserved":"0"},{"currency":"ETP","available":"0","reserved":"0"},{"currency":"EURS","available":"0","reserved":"0"},{"currency":"EVN","available":"0","reserved":"0"},{"currency":"EVX","available":"0","reserved":"0"},{"currency":"EXM","available":"0","reserved":"0"},{"currency":"EXN","available":"0","reserved":"0"},{"currency":"EXP","available":"0","reserved":"0"},{"currency":"FACE","available":"0","reserved":"0"},{"currency":"FCN","available":"0","reserved":"0"},{"currency":"FDZ","available":"0","reserved":"0"},{"currency":"FET","available":"0","reserved":"0"},{"currency":"FLP","available":"0","reserved":"0"},{"currency":"FOTA","available":"0","reserved":"0"},{"currency":"FRD","available":"0","reserved":"0"},{"currency":"FREC","available":"0","reserved":"0"},{"currency":"FTT","available":"0","reserved":"0"},{"currency":"FTX","available":"0","reserved":"0"},{"currency":"FUEL","available":"0","reserved":"0"},{"currency":"FUN","available":"0","reserved":"0"},{"currency":"FXT","available":"0","reserved":"0"},{"currency":"FYN","available":"0","reserved":"0"},{"currency":"FYP","available":"0","reserved":"0"},{"currency":"GAME","available":"0","reserved":"0"},{"currency":"GAS","available":"0","reserved":"0"},{"currency":"GBX","available":"0","reserved":"0"},{"currency":"GET","available":"0","reserved":"0"},{"currency":"GNO","available":"0","reserved":"0"},{"currency":"GNT","available":"0","reserved":"0"},{"currency":"GNX","available":"0","reserved":"0"},{"currency":"GRPH","available":"0","reserved":"0"},{"currency":"GRIN","available":"0","reserved":"0"},{"currency":"GRMD","available":"0","reserved":"0"},{"currency":"GST","available":"0","reserved":"0"},{"currency":"GT","available":"0","reserved":"0"},{"currency":"GUP","available":"0","reserved":"0"},{"currency":"GUSD","available":"0","reserved":"0"},{"currency":"GVT","available":"0","reserved":"0"},{"currency":"HAC","available":"0","reserved":"0"},{"currency":"HAND","available":"0","reserved":"0"},{"currency":"HBAR","available":"0","reserved":"0"},{"currency":"HBT","available":"0","reserved":"0"},{"currency":"HBZ","available":"0","reserved":"0"},{"currency":"HDG","available":"0","reserved":"0"},{"currency":"HEDG","available":"0","reserved":"0"},{"currency":"HERO","available":"0","reserved":"0"},{"currency":"HGT","available":"0","reserved":"0"},{"currency":"HIRE","available":"0","reserved":"0"},{"currency":"HLW","available":"0","reserved":"0"},{"currency":"HMQ","available":"0","reserved":"0"},{"currency":"HOT","available":"0","reserved":"0"},{"currency":"HPC","available":"0","reserved":"0"},{"currency":"HQX","available":"0","reserved":"0"},{"currency":"HRB","available":"0","reserved":"0"},{"currency":"HSR","available":"0","reserved":"0"},{"currency":"HT","available":"0","reserved":"0"},{"currency":"HTML","available":"0","reserved":"0"},{"currency":"HVN","available":"0","reserved":"0"},{"currency":"ICN","available":"0","reserved":"0"},{"currency":"ICO","available":"0","reserved":"0"},{"currency":"ICOS","available":"0","reserved":"0"},{"currency":"ICX","available":"0","reserved":"0"},{"currency":"IDH","available":"0","reserved":"0"},{"currency":"IDRT","available":"0","reserved":"0"},{"currency":"IFT","available":"0","reserved":"0"},{"currency":"IGNIS","available":"0","reserved":"0"},{"currency":"IHT","available":"0","reserved":"0"},{"currency":"IML","available":"0","reserved":"0"},{"currency":"IND","available":"0","reserved":"0"},{"currency":"INDI","available":"0","reserved":"0"},{"currency":"INK","available":"0","reserved":"0"},{"currency":"INSUR","available":"0","reserved":"0"},{"currency":"IOST","available":"0","reserved":"0"},{"currency":"IOTA","available":"0","reserved":"0"},{"currency":"IOTX","available":"0","reserved":"0"},{"currency":"IPL","available":"0","reserved":"0"},{"currency":"IPX","available":"0","reserved":"0"},{"currency":"IQ","available":"0","reserved":"0"},{"currency":"ITS","available":"0","reserved":"0"},{"currency":"IVY","available":"0","reserved":"0"},{"currency":"IXT","available":"0","reserved":"0"},{"currency":"JBC","available":"0","reserved":"0"},{"currency":"JNT","available":"0","reserved":"0"},{"currency":"JOT","available":"0","reserved":"0"},{"currency":"KBC","available":"0","reserved":"0"},{"currency":"KBR","available":"0","reserved":"0"},{"currency":"KICK","available":"0","reserved":"0"},{"currency":"KEY","available":"0","reserved":"0"},{"currency":"KIN","available":"0","reserved":"0"},{"currency":"KIND","available":"0","reserved":"0"},{"currency":"KMD","available":"0","reserved":"0"},{"currency":"KNC","available":"0","reserved":"0"},{"currency":"KRL","available":"0","reserved":"0"},{"currency":"KRM","available":"0","reserved":"0"},{"currency":"KRWB","available":"0","reserved":"0"},{"currency":"LA","available":"0","reserved":"0"},{"currency":"LAMB","available":"0","reserved":"0"},{"currency":"LAT","available":"0","reserved":"0"},{"currency":"LATX","available":"0","reserved":"0"},{"currency":"LCC","available":"0","reserved":"0"},{"currency":"LDC","available":"0","reserved":"0"},{"currency":"LEND","available":"0","reserved":"0"},{"currency":"LEO","available":"0","reserved":"0"},{"currency":"LIFE","available":"0","reserved":"0"},{"currency":"LINK","available":"0","reserved":"0"},{"currency":"LNC","available":"0","reserved":"0"},{"currency":"LND","available":"0","reserved":"0"},{"currency":"LOC","available":"0","reserved":"0"},{"currency":"LOOM","available":"0","reserved":"0"},{"currency":"LRC","available":"0","reserved":"0"},{"currency":"LSK","available":"0","reserved":"0"},{"currency":"LTC","available":"0","reserved":"0"},{"currency":"LUC","available":"0","reserved":"0"},{"currency":"LUN","available":"0","reserved":"0"},{"currency":"LWF","available":"0","reserved":"0"},{"currency":"MAID","available":"0","reserved":"0"},{"currency":"MAN","available":"0","reserved":"0"},{"currency":"MANA","available":"0","reserved":"0"},{"currency":"MATIC","available":"0","reserved":"0"},{"currency":"MCAP","available":"0","reserved":"0"},{"currency":"MCO","available":"0","reserved":"0"},{"currency":"MDA","available":"0","reserved":"0"},{"currency":"MEK","available":"0","reserved":"0"},{"currency":"MESH","available":"0","reserved":"0"},{"currency":"MESSE","available":"0","reserved":"0"},{"currency":"METP","available":"0","reserved":"0"},{"currency":"MG","available":"0","reserved":"0"},{"currency":"MIN","available":"0","reserved":"0"},{"currency":"MIPS","available":"0","reserved":"0"},{"currency":"MITH","available":"0","reserved":"0"},{"currency":"MITX","available":"0","reserved":"0"},{"currency":"MKR","available":"0","reserved":"0"},{"currency":"MLD","available":"0","reserved":"0"},{"currency":"MLN","available":"0","reserved":"0"},{"currency":"MNE","available":"0","reserved":"0"},{"currency":"MNX","available":"0","reserved":"0"},{"currency":"MOF","available":"0","reserved":"0"},{"currency":"MORPH","available":"0","reserved":"0"},{"currency":"MPK","available":"0","reserved":"0"},{"currency":"MRK","available":"0","reserved":"0"},{"currency":"MRS","available":"0","reserved":"0"},{"currency":"MRV","available":"0","reserved":"0"},{"currency":"MSP","available":"0","reserved":"0"},{"currency":"MTC","available":"0","reserved":"0"},{"currency":"MTH","available":"0","reserved":"0"},{"currency":"MTL","available":"0","reserved":"0"},{"currency":"MTX","available":"0","reserved":"0"},{"currency":"MXM","available":"0","reserved":"0"},{"currency":"MYB","available":"0","reserved":"0"},{"currency":"MYST","available":"0","reserved":"0"},{"currency":"NANJ","available":"0","reserved":"0"},{"currency":"NANO","available":"0","reserved":"0"},{"currency":"NAV","available":"0","reserved":"0"},{"currency":"NAVI","available":"0","reserved":"0"},{"currency":"NCT","available":"0","reserved":"0"},{"currency":"NDC","available":"0","reserved":"0"},{"currency":"NEBL","available":"0","reserved":"0"},{"currency":"NEO","available":"0","reserved":"0"},{"currency":"NET","available":"0","reserved":"0"},{"currency":"NEU","available":"0","reserved":"0"},{"currency":"NEXO","available":"0","reserved":"0"},{"currency":"NGC","available":"0","reserved":"0"},{"currency":"NIM","available":"0","reserved":"0"},{"currency":"NJBC","available":"0","reserved":"0"},{"currency":"NLC2","available":"0","reserved":"0"},{"currency":"NMR","available":"0","reserved":"0"},{"currency":"NOAH","available":"0","reserved":"0"},{"currency":"NPLC","available":"0","reserved":"0"},{"currency":"NPXS","available":"0","reserved":"0"},{"currency":"NTK","available":"0","reserved":"0"},{"currency":"NTO","available":"0","reserved":"0"},{"currency":"NUT","available":"0","reserved":"0"},{"currency":"NWC","available":"0","reserved":"0"},{"currency":"NXC","available":"0","reserved":"0"},{"currency":"NXT","available":"0","reserved":"0"},{"currency":"OAK","available":"0","reserved":"0"},{"currency":"OAX","available":"0","reserved":"0"},{"currency":"OCN","available":"0","reserved":"0"},{"currency":"ODN","available":"0","reserved":"0"},{"currency":"OKB","available":"0","reserved":"0"},{"currency":"OMG","available":"0","reserved":"0"},{"currency":"ONE","available":"0","reserved":"0"},{"currency":"ONT","available":"0","reserved":"0"},{"currency":"OPT","available":"0","reserved":"0"},{"currency":"ORME","available":"0","reserved":"0"},{"currency":"ORMEUS","available":"0","reserved":"0"},{"currency":"OTN","available":"0","reserved":"0"},{"currency":"OTX","available":"0","reserved":"0"},{"currency":"PAD","available":"0","reserved":"0"},{"currency":"PART","available":"0","reserved":"0"},{"currency":"PASS","available":"0","reserved":"0"},{"currency":"PAT","available":"0","reserved":"0"},{"currency":"PAX","available":"0","reserved":"0"},{"currency":"PAXG","available":"0","reserved":"0"},{"currency":"PAY","available":"0","reserved":"0"},{"currency":"PBKX","available":"0","reserved":"0"},{"currency":"PBT","available":"0","reserved":"0"},{"currency":"PBTT","available":"0","reserved":"0"},{"currency":"PCL","available":"0","reserved":"0"},{"currency":"PETH","available":"0","reserved":"0"},{"currency":"PHB","available":"0","reserved":"0"},{"currency":"PHX","available":"0","reserved":"0"},{"currency":"PING","available":"0","reserved":"0"},{"currency":"PITCH","available":"0","reserved":"0"},{"currency":"PIX","available":"0","reserved":"0"},{"currency":"PKT","available":"0","reserved":"0"},{"currency":"PLA","available":"0","reserved":"0"},{"currency":"PLBT","available":"0","reserved":"0"},{"currency":"PLR","available":"0","reserved":"0"},{"currency":"PLU","available":"0","reserved":"0"},{"currency":"PMA","available":"0","reserved":"0"},{"currency":"PMNT","available":"0","reserved":"0"},{"currency":"PNT","available":"0","reserved":"0"},{"currency":"POA","available":"0","reserved":"0"},{"currency":"POA20","available":"0","reserved":"0"},{"currency":"POE","available":"0","reserved":"0"},{"currency":"POLL","available":"0","reserved":"0"},{"currency":"POLY","available":"0","reserved":"0"},{"currency":"POST","available":"0","reserved":"0"},{"currency":"POWR","available":"0","reserved":"0"},{"currency":"PPC","available":"0","reserved":"0"},{"currency":"PPT","available":"0","reserved":"0"},{"currency":"PQT","available":"0","reserved":"0"},{"currency":"PREMINE","available":"0","reserved":"0"},{"currency":"PRG","available":"0","reserved":"0"},{"currency":"PRO","available":"0","reserved":"0"},{"currency":"PROC","available":"0","reserved":"0"},{"currency":"PRE","available":"0","reserved":"0"},{"currency":"PTOY","available":"0","reserved":"0"},{"currency":"PXG","available":"0","reserved":"0"},{"currency":"QAU","available":"0","reserved":"0"},{"currency":"QCN","available":"0","reserved":"0"},{"currency":"QKC","available":"0","reserved":"0"},{"currency":"QNTU","available":"0","reserved":"0"},{"currency":"QTUM","available":"0","reserved":"0"},{"currency":"QVT","available":"0","reserved":"0"},{"currency":"R","available":"0","reserved":"0"},{"currency":"RAISE","available":"0","reserved":"0"},{"currency":"RCN","available":"0","reserved":"0"},{"currency":"RCOIN","available":"0","reserved":"0"},{"currency":"REM","available":"0","reserved":"0"},{"currency":"REN","available":"0","reserved":"0"},{"currency":"REP","available":"0","reserved":"0"},{"currency":"REV","available":"0","reserved":"0"},{"currency":"REX","available":"0","reserved":"0"},{"currency":"RFR","available":"0","reserved":"0"},{"currency":"RIK","available":"0","reserved":"0"},{"currency":"RKC","available":"0","reserved":"0"},{"currency":"RLC","available":"0","reserved":"0"},{"currency":"RNTB","available":"0","reserved":"0"},{"currency":"ROOBEE","available":"0","reserved":"0"},{"currency":"ROOTS","available":"0","reserved":"0"},{"currency":"ROX","available":"0","reserved":"0"},{"currency":"RPM","available":"0","reserved":"0"},{"currency":"RPX","available":"0","reserved":"0"},{"currency":"RVN","available":"0","reserved":"0"},{"currency":"RVT","available":"0","reserved":"0"},{"currency":"SALT","available":"0","reserved":"0"},{"currency":"SAN","available":"0","reserved":"0"},{"currency":"SBD","available":"0","reserved":"0"},{"currency":"SBTC","available":"0","reserved":"0"},{"currency":"SC","available":"0","reserved":"0"},{"currency":"SCC","available":"0","reserved":"0"},{"currency":"SCD","available":"0","reserved":"0"},{"currency":"SCL","available":"0","reserved":"0"},{"currency":"SEELE","available":"0","reserved":"0"},{"currency":"SENSO","available":"0","reserved":"0"},{"currency":"SENT","available":"0","reserved":"0"},{"currency":"SETH","available":"0","reserved":"0"},{"currency":"SHIP","available":"0","reserved":"0"},{"currency":"SIG","available":"0","reserved":"0"},{"currency":"SILK","available":"0","reserved":"0"},{"currency":"SISA","available":"0","reserved":"0"},{"currency":"SKIN","available":"0","reserved":"0"},{"currency":"SLV","available":"0","reserved":"0"},{"currency":"SLX","available":"0","reserved":"0"},{"currency":"SMART","available":"0","reserved":"0"},{"currency":"SMS","available":"0","reserved":"0"},{"currency":"SMT","available":"0","reserved":"0"},{"currency":"SNBL","available":"0","reserved":"0"},{"currency":"SNC","available":"0","reserved":"0"},{"currency":"SNGLS","available":"0","reserved":"0"},{"currency":"SNM","available":"257.27000000","reserved":"0"},{"currency":"SNT","available":"0","reserved":"0"},{"currency":"SOC","available":"0","reserved":"0"},{"currency":"SOLVE","available":"0","reserved":"0"},{"currency":"SOZ","available":"0","reserved":"0"},{"currency":"SPC","available":"0","reserved":"0"},{"currency":"SPD","available":"0","reserved":"0"},{"currency":"SPF","available":"0","reserved":"0"},{"currency":"SRN","available":"0","reserved":"0"},{"currency":"STAK","available":"0","reserved":"0"},{"currency":"STAR","available":"0","reserved":"0"},{"currency":"STEEM","available":"0","reserved":"0"},{"currency":"STORJ","available":"0","reserved":"0"},{"currency":"STORM","available":"0","reserved":"0"},{"currency":"STQ","available":"0","reserved":"0"},{"currency":"STRAT","available":"0","reserved":"0"},{"currency":"STU","available":"0","reserved":"0"},{"currency":"STX","available":"0","reserved":"0"},{"currency":"SUB","available":"0","reserved":"0"},{"currency":"SUNC","available":"0","reserved":"0"},{"currency":"SUR","available":"0","reserved":"0"},{"currency":"SVD","available":"0","reserved":"0"},{"currency":"SWFTC","available":"0","reserved":"0"},{"currency":"SWM","available":"0","reserved":"0"},{"currency":"SWT","available":"0","reserved":"0"},{"currency":"TAAS","available":"0","reserved":"0"},{"currency":"TAU","available":"0","reserved":"0"},{"currency":"TBAR","available":"0","reserved":"0"},{"currency":"TBT","available":"0","reserved":"0"},{"currency":"TCN","available":"0","reserved":"0"},{"currency":"TDP","available":"0","reserved":"0"},{"currency":"TDS","available":"0","reserved":"0"},{"currency":"TEL","available":"0","reserved":"0"},{"currency":"TFL","available":"0","reserved":"0"},{"currency":"TGT","available":"0","reserved":"0"},{"currency":"TIME","available":"0","reserved":"0"},{"currency":"TIO","available":"0","reserved":"0"},{"currency":"TIV","available":"0","reserved":"0"},{"currency":"TIX","available":"0","reserved":"0"},{"currency":"TKA","available":"0","reserved":"0"},{"currency":"TKN","available":"0","reserved":"0"},{"currency":"TKR","available":"0","reserved":"0"},{"currency":"TKY","available":"0","reserved":"0"},{"currency":"TNT","available":"0","reserved":"0"},{"currency":"TOLL","available":"0","reserved":"0"},{"currency":"TRAC","available":"0","reserved":"0"},{"currency":"TRAD","available":"0","reserved":"0"},{"currency":"TRIGX","available":"0","reserved":"0"},{"currency":"TRST","available":"0","reserved":"0"},{"currency":"TRUE","available":"0","reserved":"0"},{"currency":"TRX","available":"0","reserved":"0"},{"currency":"TTU","available":"0","reserved":"0"},{"currency":"TUSD","available":"2.989404391000","reserved":"0"},{"currency":"TV","available":"0","reserved":"0"},{"currency":"UBT","available":"0","reserved":"0"},{"currency":"UET","available":"0","reserved":"0"},{"currency":"UGT","available":"0","reserved":"0"},{"currency":"ULTC","available":"0","reserved":"0"},{"currency":"UMT","available":"0","reserved":"0"},{"currency":"UNC","available":"0","reserved":"0"},{"currency":"USC","available":"0","reserved":"0"},{"currency":"USD","available":"117.201195034400","reserved":"0"},{"currency":"USDC","available":"0","reserved":"0"},{"currency":"USDT20","available":"0","reserved":"0"},{"currency":"USE","available":"0","reserved":"0"},{"currency":"USG","available":"0","reserved":"0"},{"currency":"UTK","available":"0","reserved":"0"},{"currency":"UTNP","available":"0","reserved":"0"},{"currency":"UTT","available":"0","reserved":"0"},{"currency":"UUU","available":"0","reserved":"0"},{"currency":"VEO","available":"0","reserved":"0"},{"currency":"VERI","available":"0","reserved":"0"},{"currency":"VET","available":"0","reserved":"0"},{"currency":"VIB","available":"0","reserved":"0"},{"currency":"VIBE","available":"0","reserved":"0"},{"currency":"VIO","available":"0","reserved":"0"},{"currency":"VIT","available":"0","reserved":"0"},{"currency":"VITAE","available":"0","reserved":"0"},{"currency":"VME","available":"0","reserved":"0"},{"currency":"VOCO","available":"0","reserved":"0"},{"currency":"VOISE","available":"0","reserved":"0"},{"currency":"VRA","available":"0","reserved":"0"},{"currency":"VSYS","available":"0","reserved":"0"},{"currency":"W3C","available":"0","reserved":"0"},{"currency":"WAVES","available":"0","reserved":"0"},{"currency":"WAXP","available":"0","reserved":"0"},{"currency":"WBTC","available":"0","reserved":"0"},{"currency":"WEALTH","available":"0","reserved":"0"},{"currency":"WIKI","available":"0","reserved":"0"},{"currency":"WILD","available":"0","reserved":"0"},{"currency":"WIN","available":"0","reserved":"0"},{"currency":"WINGS","available":"0","reserved":"0"},{"currency":"WITH","available":"0","reserved":"0"},{"currency":"WIZ","available":"0","reserved":"0"},{"currency":"WLK","available":"0","reserved":"0"},{"currency":"WMGO","available":"0","reserved":"0"},{"currency":"WRC","available":"0","reserved":"0"},{"currency":"WTC","available":"0","reserved":"0"},{"currency":"WTT","available":"0","reserved":"0"},{"currency":"XAUR","available":"0","reserved":"0"},{"currency":"XBP","available":"0","reserved":"0"},{"currency":"XCLR","available":"0","reserved":"0"},{"currency":"XCON","available":"0","reserved":"0"},{"currency":"XDN","available":"0","reserved":"0"},{"currency":"XDNCO","available":"0","reserved":"0"},{"currency":"XEM","available":"0","reserved":"0"},{"currency":"XLC","available":"0","reserved":"0"},{"currency":"XLM","available":"0.50000000","reserved":"0"},{"currency":"XMC","available":"0","reserved":"0"},{"currency":"XMO","available":"0","reserved":"0"},{"currency":"XMR","available":"0","reserved":"0.200000000"},{"currency":"XNS","available":"0","reserved":"0"},{"currency":"XRC","available":"0","reserved":"0"},{"currency":"XRP","available":"0","reserved":"0"},{"currency":"XTZ","available":"0","reserved":"0"},{"currency":"XUC","available":"0","reserved":"0"},{"currency":"XVG","available":"0","reserved":"0"},{"currency":"XZC","available":"0","reserved":"0"},{"currency":"YCC","available":"0","reserved":"0"},{"currency":"YOYOW","available":"0","reserved":"0"},{"currency":"ZAP","available":"0","reserved":"0"},{"currency":"ZEC","available":"0","reserved":"0"},{"currency":"ZEN","available":"0","reserved":"0"},{"currency":"ZIL","available":"0","reserved":"0"},{"currency":"ZPR","available":"0","reserved":"0"},{"currency":"ZPT","available":"0","reserved":"0"},{"currency":"ZRC","available":"0","reserved":"0"},{"currency":"ZRX","available":"0","reserved":"0"},{"currency":"ZSC","available":"0","reserved":"0"}]
     */
    public static BigDecimal parseTradingBalanceAvailaible(final String jsonString, final String currency) throws IOException {
        GateUtils.checkParamNotEmpty(currency, "currency");

        for (JsonNode currencyNode : mapper.readTree(jsonString)) {
            if (currency.equals(currencyNode.get("currency").asText())) {
                return new BigDecimal(currencyNode.get("available").asText());
            }
        }
        return null;
    }

    /**
     * {"BTCUSD":{"symbol":"BTCUSD","ask":[{"price":"6882.82","size":"0.20000"},{"price":"6882.83","size":"0.12978"},{"price":"6882.84","size":"0.20000"},{"price":"6882.85","size":"0.20000"},{"price":"6882.86","size":"4.00000"}],"bid":[{"price":"6880.56","size":"0.06200"},{"price":"6878.23","size":"0.06671"},{"price":"6878.22","size":"0.13103"},{"price":"6878.21","size":"0.30400"},{"price":"6878.05","size":"4.00000"}],"timestamp":"2020-04-10T13:51:26.236Z"}}
     */
    private static List<OrderbookEntry> parseOrderBookByBookType(String jsonString, String symbol, String bookType, int limit) throws IOException {
        JsonNode root = mapper.readTree(jsonString);
        JsonNode symbolNode = root.get(symbol);
        List<OrderbookEntry> entryList = new ArrayList<>(limit);
        if (Objects.nonNull(symbolNode)) {
            int i = 0;
            for (JsonNode entry : symbolNode.get(bookType)) {
                i++;
                entryList.add(new OrderbookEntry(
                        new BigDecimal(entry.get("price").asText()), new BigDecimal(entry.get("size").asText())));
                if (i == limit) {
                    break;
                }
            }
        }

        return entryList;
    }

    public static List<OrderbookEntry> parseOrderbookAsk(String jsonString, String symbol, int limit) throws IOException {
        return parseOrderBookByBookType(jsonString, symbol, "ask", limit);
    }

    public static List<OrderbookEntry> parseOrderbookBid(String jsonString, String symbol, int limit) throws IOException {
        return parseOrderBookByBookType(jsonString, symbol, "bid", limit);
    }

    /**
     * {"id":234887577810,"clientOrderId":"ca1bb82fb2e72674e82b3bfb0ea5a9d0","symbol":"BTCUSD","side":"buy","status":"new","type":"limit","timeInForce":"GTC","price":"5820.38","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-04-21T12:10:26.117Z","updatedAt":"2020-04-21T12:10:26.117Z"}
     */
    public static Order parseOrderResponse(String jsonString) throws IOException {
        return parseOrder(mapper.readTree(jsonString));
    }

    /**
     * {"id":234887577810,"clientOrderId":"ca1bb82fb2e72674e82b3bfb0ea5a9d0","symbol":"BTCUSD","side":"buy","status":"new","type":"limit","timeInForce":"GTC","price":"5820.38","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-04-21T12:10:26.117Z","updatedAt":"2020-04-21T12:10:26.117Z"}
     */
    public static String parseCheckOrderStatusResponse(String jsonString) {
        return parseStatus(jsonString);
    }

    /**
     * {"id":234887577810,"clientOrderId":"ca1bb82fb2e72674e82b3bfb0ea5a9d0","symbol":"BTCUSD","side":"buy","status":"canceled","type":"limit","timeInForce":"GTC","price":"5820.38","quantity":"0.00200","postOnly":false,"cumQuantity":"0","createdAt":"2020-04-21T12:10:26.117Z","updatedAt":"2020-04-21T12:10:26.404Z"}
     */
    public static String parseCancelOrderResponse(String jsonString) {
        return parseStatus(jsonString);
    }

    private static String parseStatus(String inputString) {
        Pattern pattern = Pattern.compile("\"status\":\"([a-z]+)\",");
        Matcher matcher = pattern.matcher(inputString);
        if (matcher.find()) {
            return matcher.group(1);
        }
        return null;
    }

    private static Order parseOrder(JsonNode orderNode) {
        JsonNode priceNode = orderNode.get("price");
        BigDecimal price = null;
        if (priceNode != null) {
            String priceStr = priceNode.asText();
            if (priceStr != null && !priceStr.isBlank()) {
                price = new BigDecimal(priceStr);
            }
        }
        Order order = new Order("hitbtc",
                orderNode.get("symbol").asText(),
                orderNode.get("clientOrderId").asText(),
                price,
                new BigDecimal(orderNode.get("quantity").asText()),
                orderNode.get("status").asText(),
                hitbtcTimeDateToMilliseconds(orderNode.get("createdAt").asText()),
                orderNode.get("side").asText(),
                null,
                null);

        JsonNode tradesReport = orderNode.get("tradesReport");
        if (tradesReport != null) {
            for (JsonNode entry : tradesReport) {
                order.addOrderFill(new BigDecimal(entry.get("price").asText()), new BigDecimal(entry.get("quantity").asText()));
            }
        }

        return order;
    }

    /**
     * [{"symbol":"BTCUSD","ask":"16028.30","bid":"16028.14","last":"16032.55","low":"15710.99","high":"16158.80","open":"15841.03","volume":"14329.62696","volumeQuote":"228724496.2662842","timestamp":"2020-11-15T10:15:40.197Z"},{"symbol":"ETHBTC","ask":"0.028598","bid":"0.028597","last":"0.028603","low":"0.028578","high":"0.029006","open":"0.028929","volume":"65300.1244","volumeQuote":"1879.8036890764","timestamp":"2020-11-15T10:15:40.190Z"}]
     */
    public static List<Ticker> parseTickers(String jsonString) throws IOException {
        List<Ticker> tickers = new ArrayList<>();

        JsonNode root = mapper.readTree(jsonString);
        for (JsonNode entry : root) {
            tickers.add(new Ticker(
                    entry.get("symbol").asText(),
                    new BigDecimal(entry.get("last").asText())));
        }

        return tickers;
    }

}

